---
import SignIn from "auth-astro/src/components/SignIn.astro";
import SignOut from "auth-astro/src/components/SignOut.astro";
import { getSession } from "@/lib/session";

const req = Astro.request;
const session = await getSession(req);
---

<header class="w-full bg-gradient-to-r from-gray-900 to-gray-800">
  <nav
    class="m-auto flex w-full items-center justify-between gap-2 px-5 py-2 lg:w-3/4"
  >
    <div class="flex gap-2">
      <p
        class="flex size-10 items-center justify-center rounded bg-blue-800 text-lg font-bold text-white"
      >
        T
      </p>
      <p class="flex items-center justify-center text-lg font-bold text-white">
        Task Generator
      </p>
    </div>
    <div class="">
      {
        !session && (
          <SignIn
            class="h-10 cursor-pointer rounded-xs bg-blue-800 px-4 py-1 text-white transition-colors hover:bg-blue-950"
            provider="atlassian"
          >
            Log In
          </SignIn>
        )
      }
      {
        session && (
          <div class="flex items-center gap-2">
            <SignOut class="h-10 cursor-pointer rounded-xs bg-red-800 px-4 py-1 text-white transition-colors hover:bg-red-950">
              Log out
            </SignOut>
            <img
              class="w-10 rounded-full"
              src={session.user?.image}
              alt="user avatar"
            />
          </div>
        )
      }
    </div>
  </nav>
</header>
